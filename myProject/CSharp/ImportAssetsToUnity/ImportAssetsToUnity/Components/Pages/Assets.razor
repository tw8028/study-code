@page "/assets-{Category}"
@using ImportAssetsToUnity.Components.Layout
@using ImportAssetsToUnity.Components.Pages.Template
@using ImportAssetsToUnity.Domain.Entities
@using ImportAssetsToUnity.Domain.Services
@using ImportAssetsToUnity.Infrastructure
@layout CategoryMenu
<PageTitle>Assets</PageTitle>

<div class="btn-group-toggle" data-toggle="buttons">
    <label class="btn btn-secondary active">
        <input type="checkbox" @onchange="OnChange"> All
    </label>
</div>
@if (data.Count() != 0)
{
    <TddTable Data="@data">
        <HeaderTemplate>
            <th>Name</th>
            <th>State</th>
            <th>Action</th>
        </HeaderTemplate>
        <RowTemplate>
            <td>@context.Name</td>
            <td>
                @if (context.State == CheckResult.Equal)
                {
                    <span class="alert-success">&#10003</span>
                }
                else
                {
                    <span class="alert-warning">@context.State</span>
                }
            </td>
        </RowTemplate>
        <Action Context="row">
            <td>
                <button class="btn btn-primary btn-sm" @onclick="()=>row.CopyTo()">copy to unity</button>
            </td>
        </Action>
    </TddTable>
}

@code {
    [Parameter] public string? Category { get; set; }
    IEnumerable<AssetInfo> data = [];

    protected override void OnParametersSet()
    {
        IAssets? item = AssetsFactory.Get().SingleOrDefault(name => name.GetName() == Category);
        if (item != null) data = item.GetAssetsInfo();
    }

    private void OnChange()
    {
    }

}